---
output: pdf_document
sansfont : Times New Roman 
toc: TRUE
toc_depth : 1
fontsize : 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

\newpage

**Group Members**

Name                  Roll No.
----------            --------
Aaryan Mallayanmath     4565
Rohit Fuke              4530    
Sudhansu Bhadra         4537   
Tanmay Shah             4541 
Mukta Wagh              4508    
Rutvik Aglawe           4568   
Chaitanyakumar Devkar   4546

**Project Guide :- Prof. Deepa Kulkarni**

\newpage

# Acknowledgement

We wish to thank the Department of Statistics, Fergusson College (Autonomous), Pune for giving us an opportunity to do this project .

This project has been completed under the valuable guidance of Prof. Deepa Kulkarni.We would like to express our profound gratitude towards her for her patient guidance, valuable and constructive suggestions for this research project. We appreciate her willingness for motivating and keeping our progress on schedule.
  
We would also like to extend a special thanks to the Head of the Department of Statistics, Prof. Subhash
S. Shende for his encouragement and support throughout the course of the project.

We would also like to thank the other staff members for the support, suggestions and 
encouragement. Finally, we would like to express our gratitude to our family and friends for offering us tremendous assistance and contributing to this project during the process of data collection.

\newpage

# Objectives and Statistical Tools Used
\
**Objectives**\

•	To draw various graphs and check relationship between different attributes\

•	To check the relationship between Education Level and Familiarity with Solar Energy and Policies related to Solar Development.\

•	To check the relationship between Occupation and willingness to Install Solar Panels at Home.\

•	To check the relationship between Education Level and Awareness of Government schemes related to usage Solar Energy.\

•	To check the relationship between CO2 Emission (Dependent variable/Response Variable) and Coal Production in India (Independent Variable/Regressor)\

•	To check the relationship between Electricity Generation (Dependent variable/Response Variable) and Coal Production in India (Independent Variable/Regressor)\

•	To develop a forecasting model using **ARIMA Modelling** technique to predict the future trend in Consumption of Coal in India.\

•	To develop a forecasting model using **Holt-Winters** method and **ARIMA** technique to predict the future trend in Production of Coal in India and check the accuracy of both the models.\
\
**Tools Used:**\

**1] Exploratory Data Analysis**\

**2] Chi Square Test of Independence of Attributes**\

**3] Linear Regression**\

**4]Time Series Analysis**\

\newpage
# Introduction and Overview

Coal in India has been mined since 1774, and India is the second largest producer and consumer of coal after China, mining 716 million metric tons (789 million short tons) in 2018. Coal supplies over 40% of energy in India. Around 30% of coal is imported. Due to high demand and poor average quality, India imports coking coal to meet the requirements of its steel plants. Dhanbad, the largest coal producing city, has been called the coal capital of India. State-owned Coal India had a monopoly on coal mining between its nationalization in 1973 and 2018. Most of the coal is burned to generate electricity and most electricity is generated by coal, but coal-fired power plants have been criticized for breaking environmental laws. The health and environmental impact of the coal industry is serious, and phasing out coal would have short-term health and environmental benefits greatly exceeding the costs. Electricity from new solar farms in India is cheaper than that generated by the country's existing coal plants. 
  
The production of coal was 716.08 million metric tons (789.34 million short tons) in 2020–21, a decline of 2.02% over the previous year primarily due to disruptions caused by the COVID-19 pandemic. The production of lignite was 36.61 million metric tons (40.36 million short tons) in 2020–21, a decrease of 13.04% over the previous fiscal. Production of coal grew by an compound annual growth rate (CAGR) of 3.19%, and production of lignite declined by a CAGR of 1.60% over the last 10 years. Coal mining is one of India's most dangerous jobs. India targets to increase its coal production to 1,200 million metric tons (1,300 million short tons) by 2023-24. Washing Coal is an integral part of the coal production process in which raw coal from mines is washed to remove the ash content to make it fit for feeding into boilers such as those in steel plants. Coal washeries are generally not a part of coal mines in India, with some exceptions. There were 60 coal washeries (19 coking and 41 non-coking) in India as on 31 March 2021 with a total installed capacity of 138.58 million tonnes per year, of which 108.60 million tonnes are non-coking and 29.98 million tonnes are coking coal washeries.

\newpage 

# Motivation

Coal is the most important and abundant fossil fuel in India. It accounts for 55% of the country's energy need. The country's industrial heritage was built upon indigenous coal. Commercial primary energy consumption in India has grown by about 700% in the last four decades. Driven by the rising population, expanding economy and a quest for improved quality of life, energy usage in India is expected to rise. Considering the limited reserve potentiality of petroleum & natural gas, eco-conservation restriction on hydel project and geo-political perception of nuclear power, coal will continue to occupy centre-stage of India 's energy scenario. 

In October 2021, as the economy recovered from the pandemic’s second wave, a sharp surge in energy demand triggered a spiraling fuel shortage across coal-fired thermal stations. Due to several factors, India is staring at a coal crisis again, and the Indian Railways has cancelled trains to prioritize delivery of coal rakes across the country.

The motivation for doing this project is to the understand the behavioral pattern of the production of coal and it's demand within the country. We would also like to know the effects production of coal has on the emission of CO2 gas and generation of electricity in the country. Finally with the help of a short survey, we want to check the people's knowledge and opinions towards Solar as an alternative source of energy.

\newpage
# Exploratory Data Analysis

```{r,echo=FALSE,warning=FALSE,fig.align='left'}
library('readxl')
solarrr <- read_excel("C:/Mallu/Project/solarrr.xlsx")
d=data.frame(solarrr)
z=d$Age
z1=d$Shifting
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(0.55,80.72,0,9.21,0,3.35,0,5.58,0.27,0.27), ncol = 2, nrow = 5, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),main = "Do you think shifting to solar is good for enviorment?",xlab="Do you think shifting to solar is good?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100),beside = TRUE)
text(x=b,y=values,labels=values,pos=3)

```
**INTERPRETATION:**
From the graph it is easy to see that almost all people from the different age groups think that it is good to shift towards Solar as primary source of energy.

```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z=d$Age
z1=d$save.energy
t=table(z1,z)
a=c("NO","YES")
values=matrix(c(6.14,75.13,0.55,8.65,0.27,3.07,0.83,4.74,0.27,0.27), ncol = 2, nrow = 5, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Are you looking forward to invest in solar energy to save on energy costs?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100), beside = TRUE)
text(x=b,y=values,labels=values,pos=3)

```
**INTERPRETATION:**
Here we can see that people from all most all age groups are looking forwards to invest in solar energy to save on energy costs. A very small amount of people from the age group 15-25 are against this thought.
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z=d$Age
z1=d$Invest.in.5yr
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(3.07,78.21,0.27,8.93,0.55,2.8,0,5.58,0.27,0.27), ncol = 2, nrow = 5, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Do you think you or your family will start investing in clean energy over the next 5 years?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100),beside = TRUE)
text(x=b,y=values,labels=values,pos=3)
```
**INTERPRETATION:**
Almost 100% of people from different age groups are positive about investing in clean energy over the next 5 years.
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z=d$Age
z1=d$govt.benefits
t=table(z1,z)
a=c("NO","YES")
values=matrix(c(37.9,43.3,4.18,5.02,0.55,2.8,1.95,3.63,0.55,0), ncol = 2, nrow = 5, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Are you aware of the government benefits for solar energy?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100),beside = TRUE)
text(x=b,y=values,labels=values,pos=3)
```
**INTERPRETATION:**
Amount of people knowing and not knowing about the government benefits for solar energy is almost same. We can see that a greater number of people within the age group 15-25 know about government benefits.
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z=d$Age
z1=d$Compromise
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(56.42,24.86,6.98,2.23,2.23,1.11,4.18,1.4,0.27,0.27), ncol = 2, nrow = 5, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Would you compromise on the quality of installation of solar products?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100),beside = TRUE)
text(x=b,y=values,labels=values,pos=3)
```
**INTERPRETATION:**
From the bar plot it is easy to make out that a greater number of people won't compromise on the quality of installation of solar products.
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z=d$Education
z1=d$save.energy
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(4.46,62.84,0.27,1.4,1.11,17.03,2.23,10.61), ncol = 2, nrow = 4, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Are you looking forward to investing in solar energy to save on energy costs?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100),beside = TRUE)
text(x=b,y=values,labels=values,pos=3)

```
**INTERPRETATION:**
According to the graph, most of people with different education levels are looking for to investing in Solar to save on energy costs.

```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z=d$Education
z1=d$Compromise
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(45.53,21.78,1.11,0.55,13.12,5.02,10.33,2.51), ncol = 2, nrow = 4, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Would you compromise on the quality of solar products?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100), beside = TRUE)
text(x=b,y=values,labels=values,pos=3)

```
**INTERPRETATION:**
Most people with a Bachelors Degree will not compromise on the quality of solar products. Whereas, more people with Doctoral Degree are willing to compromise.

```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z=d$Education
z1=d$govt.benefits
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(29.6,37.70,0.55,1.11,10.61,7.54,4.6,8.37), ncol = 2, nrow = 4, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Are you aware of the government benefits for solar energy?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue"),ylim=c(0,100))
```
**INTERPRETATION:**
The number of people with different education levels knowing about goverenment benefits is almost equal to the number of people not knowing about the government benefits.
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
d=data.frame(solarrr)
z=d$Occupation
z1=d$Shifting
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(0,3.07,0,0.55,0,16.48,0,6.98,0.55,70.11,0.27,1.95), ncol = 2, nrow = 6, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.32)),xlab="Do you think shifting to solar is good for the environment?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue","yellow"),ylim=c(0,100),beside = TRUE)
text(x=b,y=values,labels=values,pos=3)
```
**INTERPRETATION:**
We can say that different occupations do not hamper the peoples opinion about solar energy being good for the environment.
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
#11
z=d$Occupation
z1=d$Invest.in.5yr
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(0.27,2.8,0.27,0.27,0.83,15.64,0,6.98,2.51,68.15,0.27,1.95), ncol = 2, nrow = 6, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.32)),xlab="Do you think you or your family will start investing in clean energy over the next 5 years?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue","yellow"),ylim=c(0,100), beside = TRUE)
text(x=b,y=values,labels=values,pos=3)
```
**INTERPRETATION:**
People from all various kinds of occupation are looking forward to investing in Solar energy over the next 5 years.

```{r,echo=FALSE,warning=FALSE,fig.align='left'}
z1=d$govt.benefits
t=table(z,z1)
a=c("NO","YES")
values=matrix(c(1.11,1.95,0.27,0.27,8.10,8.37,1.67,5.30,33.51,37.15,0.55,1.67), ncol = 2, nrow = 6, byrow=TRUE)
b=barplot(values,names.arg = a,legend.text = rownames(table(z,z1)),args.legend =list(x="topright",inset = c(0,-0.1)),xlab="Are you aware of the government benefits of opting for solar energy?",ylab="Number of people",col=c("orchid2","purple2","pink","red","blue","yellow"),ylim=c(0,100), beside = TRUE)
text(x=b,y=values,labels=values,pos=3)
```
**INTERPRETATION:**
The number of people with different occupations levels knowing about government benefits is almost equal to the number of people not knowing about the government benefits.


\newpage
# Confirmatory Data Analysis 
\
**$\chi^2$ Test for Independence of Attributes**

The Chi Squared statistics is commonly used for testing relationships between categorical variables. The null hypothesis for a chi squared test of independence is that two variables
are independent. This test is one -tailed. The degrees of freedom are (m-1)*(n-1). The
formula is as follows:

$\chi^2=\sum_{i=1}^{m}\sum_{j=1}^{n}\frac{(O_{ij}-E_{ij})^2}{E_{ij}}$

where\ $O_i$ = Observed frequency\
$E_i$ = Expected frequency\
Degrees of freedom = (m-1)(n-1)\
m = Number of columns\
n = Number of rows\

**Decision Rule** : \
Reject Ho if $p-value \le \alpha$  \
**OR**\
Reject $H_{o}$ at $\alpha$ % l.o.s if
$\chi^2_{calc} \ge \chi^2_{(m-1)(n-1),\alpha}$ \


**1]How familiar are you with solar energy (i.e. solar panels or solar PV) and policies related to solar development.**\
Let,\
A = Education level\
Classes of A=3\
A1=Bachelor’s degree\
A2=Master’s degree\
A3=High school graduate\
And\
B=How familiar are you with solar energy (i.e. solar panels or solar PV) and policies related to solar development\
Classes of B=3\
B1=Moderately familiar\
B2=Not at all familiar\
B3=Very familiar\

**Hypothesis:**\
To Test\
$H_{o}$: A and B are Independent\
Vs\
$H_{1}$: A and B are Associated\

```{r ,echo=FALSE,warning=FALSE}
A=matrix(c(45.53,2.8,19,6.42,1.39,5.03,13.97,1.68,4.19),ncol=3,nrow=3,byrow = TRUE)
chisq.test(A)
```

Here, as
$p-value \ge \ 0.05$\
**AND**\
$\chi^2_{calc} \le\chi^2_{4;0.05}=9.487729$ \

Therefore we may ACCEPT Ho

**CONCLUSION:**
We conclude that people’s knowledge about solar energy and their education levels are independent.\


**2]Occupation of people and willingness to install solar panels at home**\
Let\
A=Occupation\
Classes of A=4\
A1=Students\
A2=Salaried employee\
A3=Self-employed/Business owner\
A4=Unemployed\
And\
B= installment of solar panel at home\
B1=Yes, I have solar panels at my home\
B2=No, I don’t have enough rooftop space\
B3=No,I find it costly\
B4=No,it is high maintenance\

**Hypothesis:**\
To Test\
$H_{o}$: A and B are Independent\
Vs\
$H_{1}$: A and B are Associated\

```{r ,echo=FALSE,warning=FALSE}
C=matrix(c(20.9497,28.4916,12.0117,6.4245,3.6312,6.4245,5.5865,1.3966,3.0726,2.5139,1.3966,1.6759,1.9553,1.6759,1.3966,1.39664),ncol=4,nrow=4,byrow = TRUE)
chisq.test(C)
```
Here, as
$p-value \ge \ 0.05$\
**AND**\
$\chi^2_{calc} \le\chi^2_{9;0.05}=16.91898$ \

Therefore we may ACCEPT Ho

**CONCLUSION:**
We conclude that occupation of people and their willingness to install solar panels at home are independent.\

**3]Education of people and awareness of government policies related to solar energy .**\
Let\
A=Education\
Classes of A=3\
A1=Bachelor’s degree\
A2=Master’degree\
A3=High school graduate\
And\
B= Are you aware of government scheme\
Classes of B=2\
B1=Yes\
B2=No\

**Hypothesis:**\
To Test\
$H_{o}$: A and B  are Independent\
Vs\
$H_{1}$: A and B are Associated\

```{r ,echo=FALSE,warning=FALSE}
B=matrix(c(37.7,29.7,8.37,4.48,8.38,11.46),ncol=2,nrow=3,byrow = TRUE)
chisq.test(B)
``` 
Here, as
$p-value \ge \ 0.05$\
**AND**\
$\chi^2_{calc} \le\chi^2_{2;0.05}=5.99146$ \

Therefore we may ACCEPT Ho

**CONCLUSION:**
We conclude that awareness of government policies related to solar energy and education of people are independent.

\newpage

# Time Series Analysis

A time series is a series of data points indexed or listed in time order. It can be continuous trace 
or discrete set of observations. Here we are dealing with observations taken at discrete time 
periods. By appropriate choice of origin and scale we can take the time periods to be 1, 2,...\

**Modelling:** We observe the pattern in data and fit a time series model to data. This model 
depends on unknown parameters which need to be estimated.\

**Forecasting:** On the basis of available observations we predict the further observations with the 
help of different time series forecasting techniques which suit our data.\

**Analysis of data:**\
Here for forecasting we have used two techniques:\
1] Triple Exponential Smoothing(Holt-winters)\
2] ARIMA Modelling\

**HOLTWINTERS TRIPLE EXPONENTIAL SMOOTHING:**
Exponential smoothing is a very popular technique to produce a smoothed time series. Exponential 
smoothing assigns exponentially decreasing weights as the observation get older. Recent 
observations are given relatively more weights in forecasting than the older observations. It is 
usually used to make short term forecasts.

**ARIMA MODELLING:**

ARIMA stands for Autoregressive Integrated Moving Average. This model is fitted to the time 
series data either to better understand the data or to predict future points in the series.
The AR part of ARIMA indicates that the evolving variable of interest is regressed on its own 
lagged values. The MA part indicates that the regression error is actually a linear combination of 
error terms whose values occurred contemporaneously and at various times in the past.
Non seasonal ARIMA Models are generally denoted by ARIMA(p,d,q) where parameters p,d 
and q are non negative integers.\

P = order of autoregressive model\

q = order of the moving average model\

d = degree of differencing\

**Differencing:** In statistics, differencing is the transformation applied to the time series data in 
order to make it stationary. In order to difference the data, the difference between consecutive 
observations is computed. Differencing removes the changes in the level of time series, 
eliminating trend and seasonality and consequently stabilizing the mean of the time series\

**1] Analysis of Coal Consumption in India.**\
```{r ,message=FALSE, warning=FALSE, ,echo=FALSE, paged.print=FALSE,fig.align='left'}
library('readxl')
library('TTR')
library('tseries')
library('forecast')
library('Metrics')

coal_c <- read_excel("C:/Users/malla/Downloads/coal-consumption-by-country-terawatt-hours-twh.xlsx")
coalc_ts=ts(coal_c$Value,start = c(1965,1), frequency = 1)
plot(coalc_ts)
cmodel=auto.arima(coalc_ts,ic="aic",trace = TRUE)
b=forecast(cmodel)
plot(b)
summary(b)

```
**We can see that the forecasts show a downward trend for the next 10 years. In the original time series plot, we can see that there is a sudden dip in the value of coal consumption. We assume that this is due to the COVID 19 Pandemic. To see whether this irregularity affects the forecast, we try and extrapolate the value for the year 2020. We do this by plotting a time series till year 2019 and then forecast the year 2020's value and then replacing this value with the original value.**
```{r ,echo=FALSE,warning=FALSE}
training_set = subset(coal_c,subset = coal_c$Year>='1965' & coal_c$Year <='2019')
coal_cts=ts(training_set$Value,start = c(1965,1), frequency = 1)
plot(coal_cts)
cmodel=auto.arima(coal_cts,ic="aic",trace = TRUE)
b=forecast(cmodel,h=1)
plot(b)
summary(b)
```
**Here we can see that the forecasted Value of year 2020 is 5323.38. We replace the original value with the forecasted value as 'Extrapolated Observation'**\

```{r ,echo=FALSE,warning=FALSE}
c <- read_excel("C:/Mallu/Project/c.xlsx")
c1=ts(c$Value,start = c(1965,1), frequency = 1)
plot(c1)
cmodel=auto.arima(c1,ic="aic",trace = TRUE)
b=forecast(cmodel)
plot(b)
summary(b)
```
**Here we can see that after extrapolating, the time series forecast shows an upward trend. Hence, we can say that the Irregularity is removed and to check this we will perform Residual Analysis.**

**Ljung Box or Box Pierce Test to check the Autocorrelation between Residuals**\

To Test:\
$H_{o}$:Residuals follow i.i.d rvs or White Noise\
vs\
$H_{1}$:Residual have serial dependance\
```{r ,echo=FALSE,warning=FALSE}
Box.test(resid(cmodel),type="Ljung",lag=1,fitdf=0)
```
**Again, we see that the p-value is greater than $\alpha=0.05$, thus we can accept the null hypothesis,indicating the time series does not contain any Autocorrelation.**\

```{r ,echo=FALSE,warning=FALSE}
checkresiduals(cmodel)


```
**From the ACF vs Lag graph, we can see that there is autocorrelation between the residuals. The Histogram also shows us that the residuals follow Normal Distribution.**\

**2] Analysis of Coal Production in India.**\
In this section, we check which model is fits better to the data, Holt-Winters Exponential Smoothing or ARIMA Model.\

**Holt-Winters Exponential Smoothing:**\
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
coal_p<- read_excel("C:/Mallu/Project/production.xlsx")
training_set = subset(coal_p,subset = coal_p$Year>='1900' & coal_p$Year<='2000')
test_set = subset(coal_p, subset = coal_p$Year>='2001' & coal_p$Year <='2020')
coalp_ts=ts(training_set$Value,start = c(1900,1), frequency = 1)
plot(coalp_ts)
model= HoltWinters(coalp_ts,gamma = FALSE)
plot(model)
a=forecast(model,h=20)
plot(a)
summary(a)
x=as.numeric(unlist(a$mean))            
y=as.numeric(unlist(test_set$Value))

```
\ **ROOT MEAN SQUARE ERROR(RMSE):**
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
rmse(y,x)

```

**ARIMA Model:**
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
cmodel=auto.arima(coalp_ts,ic="aic",trace = TRUE)
b=forecast(cmodel,h=20)
plot(b)
summary(b)
x=as.numeric(unlist(b$mean))            
y=as.numeric(unlist(test_set$Value))

```
\ **ROOT MEAN SQUARE ERROR(RMSE):**
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
rmse(y,x)
```
\ 
**As we can see that the RMSE of Holt Winters Model is less than the RMSE of ARIMA Model, we conclude saying that the Holt-Winters Model is a better fit than ARIMA Model for our data.**
\
**Hence, we use the Holt-Winters Model to forecast the value of coal production for the next 10 years**
```{r,echo=FALSE,warning=FALSE,fig.align='left'}
coalp_ts=ts(coal_p$Value,start=c(1900,1) , frequency=1)
plot(coalp_ts)
model= HoltWinters(coalp_ts,gamma = FALSE)
model
plot(model)
a=forecast(model,h=20)
plot(a)
summary(a)

```
\newpage
# Regression Analysis

**Simple Linear Regression Model**

Regression analysis is a set of statistical methods used for the estimation of relationships between a dependent variable and one or more independent variables. It can be utilized to assess the strength of the relationship between variables and for modeling the future relationship between them. Here, we have fitted Simple Linear Regression for two models
This analysis considers the simple linear regression model, that is, a model with a single regressor x that has a relationship with a response y that is a straight line. This simple linear regression coefficient. $Y=\beta_{0}+\beta_{1}X$ where the intercept $\beta_{0}$ and the slope $\beta_{1}$ are unknown constants and $\epsilon$ is a random error component. The errors are assumed to have mean zero and unknown variance $\sigma^{2}$. Additionally, we usually assume that the errors are uncorrelated. This means that the value of one error does not depend on the value of any other error\

**1]To check the relationship between CO2 Emission and Coal Production in India.**\

Here,\
Dependent Variable Y = CO2 Emission \
Independent Variable X = Coal Production.\

```{r,echo=FALSE,warning=FALSE}
library(readxl)
coal_production_by_country <- read_excel("C:/Mallu/Project/New folder/coal-production-by-country.xlsx")
electricity_coal <- read_excel("C:/Mallu/Project/New folder/electricity-coal.xlsx")
co2_emission <- read_excel("C:/Mallu/Project/New folder/co2 emission.xlsx")



y=co2_emission$`Annual CO2 emissions`
x=coal_production_by_country$`Coal production (TWh)`
model=lm(y~x)
summary(model)

```
From the output we can see that,\
1) The model is,  Y = -464585396 + 813506*X\
2) R-squared value or strength of the model is 0.9679\
\newpage
**Diagnostic Plots**
```{r , echo=FALSE,warning=FALSE, fig.align='left'}
par(mfrow=c(2,2))
plot(model)

```
**Conclusion:**\
From Residual Vs. Fitted Plot we conclude that relationship between CO2 Emission and Coal Production is not linear.\
\
Thus, to overcome this problem we proceed to use the *Box-Cox transformation.*\
\newpage

**Box Cox Transformation:**
A Box Cox transformation is a Transformation of non-normal dependent variables into a normal shape. At the core of the Box Cox transformation is an exponent,$\lambda$ which varies from -5 to 5. All values of $\lambda$ are considered and the optimal value for your data is selected; The “optimal value” is the one which results in the best approximation of a normal distribution curve. The transformation of Y has the form:

```{r , echo=FALSE ,warning=FALSE}

library('MASS')
bc=boxcox(y~x)
lamda=bc$x[which.max(bc$y)]
lamda
newmodel=lm(((y^lamda-1)/lamda)~x)
summary(newmodel)
par(mfrow=c(2,2))
plot(newmodel)
```
\newpage
**Hypothesis Testing**\
To Test\
$H_{o}$: $\beta_{1}=0$\
Vs\
$H_{1}$: $\beta_{1} \ne 0$\

Test Criteria:\ 
Reject $H_{o}$ if  $p-value \le 0.05$\

Decision:\
Here $p-value = 2.2e^{-16} \le 0.05$\
Therefore ,Reject $H_{o}$ \

**Conclusion:**\
1) There is relationship between CO2 Emission and Coal Production.\
2) From the above graph of Box-Cox Transformation (Residuals Vs. Fitted), we can now conclude that the relationship between CO2 Emission and Coal Production is linear.
R-Squared: 0.9679 (for Simple Regression Model)\
R-Squared: 0.9905 (for Box Cox Transformation)\
The Coefficient of Determination is Relatively High for Box Cox Transformation which implies that regression model captures most of the variability expressed by CO2 Emission while using Box-Cox Transformation.\
\newpage

**2]To check the relationship between Electricity Generation and Coal Production in India.**\

Here, \
Dependent Variable Y = Electricity Generation \
Independent Variable X = Coal Production\

```{r ,echo=FALSE,warning=FALSE,fig.align='left'}
y=electricity_coal$`Electricity from coal (TWh)`
x=coal_production_by_country$`Coal production (TWh)`
model=lm(y~x)
summary(model) 

```
From the output we can see that,\
1) The model is,  Y = Y = -291.50003 + 0.38077*X\
2) R-squared value or strength of the model is 0.9396\
\newpage
**Diagnostic Plots**
```{r , echo=FALSE,warning=FALSE, fig.align='left'}
par(mfrow=c(2,2))
plot(model)

```
**Conclusion:**\
From Residual Vs. Fitted Plot we conclude that relationship between Electrcity Generation and Coal Production is not linear.\
Thus, to overcome this problem we proceed to use the *Box-Cox transformation.*\

\newpage


**Box Cox Transformation:**
\
```{r ,echo=FALSE,warning=FALSE,fig.align='left'}
bc=boxcox(y~x)
lamda=bc$x[which.max(bc$y)]
newmodel=lm(((y^lamda-1)/lamda)~x)
summary(newmodel)
par(mfrow=c(2,2))
plot(newmodel)

```
**Hypothesis Testing**\
To Test\
$H_{o}$: $\beta_{1}=0$\
Vs\
$H_{1}$: $\beta_{1} \ne 0$\

Test Criteria:\ 
Reject $H_{o}$ if  $p-value \le 0.05$\

Decision:\
Here $p-value = 2.2e^{-16} \le 0.05$\
Therefore ,Reject $H_{o}$ \
**Conclusion:**\
1)From the above graph of Box-Cox Transformation (Residuals Vs. Fitted), we can now conclude that the relationship between Electricity Generation and Coal Production is linear.
R-Squared: 0.9396 (for Simple Regression Model)\
R-Squared: 0.9781 (for Box Cox Transformation)\
The Coefficient of Determination is Relatively High for Box Cox Transformation which implies that regression model captures most of the variability expressed by Electricity Generation while using Box-Cox Transformation.\


\newpage
# Conclusion

Through the time series plot, we can see that there has always been an increase in Consumption of Coal. With the help of extrapolation, we tried to remove the irregularity observed in the data and then forecast using the ARIMA Model.\

We also fit, both Holt-Winters Exponential Smoothing and ARIMA Model for the data of coal production and compared the accuracy of the models. We conclude that the Holt-Winters Exponential Smoothing is a better model for our data.\

With the help of Linear Regression, we compare the relation between Coal Production and CO2 Emission, and Coal Production and Electricity Generation. Although at first we don't find there to be a linear relationship, after using the Box-Cox Transformation, we conclude by saying that there is a Linear Relationship in both the models.\

With the help of forecasting, we can say that the demand of coal in the country will on increasing with time. But as we now that there is a shortage of Coal in recent times and hence depending on Coal entirely as the primary source of energy may not be the best option. Hence we have studied of Solar Energy as an alternative in particular as it in an upcoming source of Energy and it's installation is quite easy as compared to tidal energy or wind energy.\

We have done Exploratory Data analysis using primary data. Here we analyse the data through various Bar Graphs. These graphs help us understand the awareness of Solar Energy among people and their willingness to move towards the usage of clean energy with respect to different attributes such as Age, Occupation and Education.\

Finally, with the help of Chi-Square Test of Independence, we were able to determine the relation between Education and awareness of solar energy and its policies. It was found that they are independent and hence Education does not affect the level of awareness of Solar among people. Similarly, there was no relationship found between Occupation and people's willingness to install Solar panels at home. Finally, we also came to know that education level does not affect the awareness of government policies related to solar energy.\

\newpage

# Limitations and Scope
1]As the data of Indian Coal Prices was not available, we could not perform Multiple Linear Regression to check relation between dependent variable Indian Coal Prices and independent variables International Coal Prices, Import and Export of Coal in India.\
2]Due to unavailability of data of coal consumption and production for the year 2021, we could not compare the forecasted value to check the accuracy of the model as compared with the real life data.\
3]Due to restriction of time, we were not able to collect large amount of primary data from Google forms and were restricted to 358 responses.\

We have studied Solar Energy as the non conventional alternative of Coal as it can be easily utilised in our day to day lives. The installation and use of solar energy is quite easy. But we would also like to tap into the different non-conventional sources of energy such as tidal energy, wind energy, geothermal energy , etc.



# Softwares used in project

**1]R-SOFTWARE:** 
 
R is a programming language for statistical computing and graphics supported by the R Core Team and the R Foundation for Statistical Computing. R is used among data miners and statisticians for data analysis and developing statistical software. Users have created packages to augment the functions of the R language.\

**2]R- Markdown:**
R-Markdown makes use of Markdown syntax. Markdown is a very simple 'markup' language which provides methods for creating documents with headers, images, links etc. from plain text files, while keeping the original plain text file easy to read. You can convert Markdown documents to many other file types like.\

**3]EXCEL:**
  
Microsoft excel is powerful data visualization and analysis software, which uses spreadsheets to store, organize, and track data sets with formulas and functions. \

\newpage
# References

**Websites:**\
1)https://coal.gov.in \
2)https://www.statisticshowto.com \
3)thetoprated.in \
4)https://rmarkdown.rstudio.com \
5)https://ourworldindata.org \

**Books:**\
1) Introduction to Linear Regression Analysis by Douglas C. Montgomery\
2) The Analysis of Time series An Introduction by Chris Chatfield\




























